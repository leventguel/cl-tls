(load "aes-utils.lisp")
(load "ghash.lisp")
(load "aes128.lisp")
(load "aes192.lisp")
(load "aes256.lisp")
(load "aes128-gcm.lisp")
(load "aes192-gcm.lisp")
(load "aes256-gcm.lisp")
(load "rsp/rsp128-parser.lisp")
(load "rsp/rsp192-parser.lisp")
(load "rsp/rsp256-parser.lisp")

(defpackage :tls-aes-all-test
  (:use :cl :tls-aes-utils :tls-aes128 :tls-aes192 :tls-aes256 :tls-aes-ghash :tls-aes128-gcm
	:tls-aes192-gcm :tls-aes256-gcm :tls-aes-rsp128-parser :tls-aes-rsp192-parser :tls-aes-rsp256-parser))

(in-package :tls-aes-rsp128-parser)

(defun test-128 ()

  (test-ecb128-rsp            "rsp/mmt/ECBMMT128.rsp")
  (test-ecb128-rsp-decrypt    "rsp/mmt/ECBMMT128.rsp")
  (test-cbc128-rsp            "rsp/mmt/CBCMMT128.rsp")
  (test-cbc128-rsp-decrypt    "rsp/mmt/CBCMMT128.rsp")
  (test-ctr128-rsp            "rsp/ctr/CTRMMT128.rsp")
  (test-ctr128-rsp-decrypt    "rsp/ctr/CTRMMT128.rsp")
  (test-ofb128-rsp            "rsp/mmt/OFBMMT128.rsp")
  (test-ofb128-rsp-decrypt    "rsp/mmt/OFBMMT128.rsp")
  (test-cfb128-rsp            "rsp/mmt/CFB128MMT128.rsp")
  (test-cfb128-rsp-decrypt    "rsp/mmt/CFB128MMT128.rsp")
  (test128-cfb8-rsp           "rsp/mmt/CFB8MMT128.rsp")
  (test128-cfb8-rsp-decrypt   "rsp/mmt/CFB8MMT128.rsp")
  (test128-cfb1-rsp           "rsp/mmt/CFB1MMT128.rsp")
  (test128-cfb1-rsp-decrypt   "rsp/mmt/CFB1MMT128.rsp")
  (test128-gcm-rsp            "rsp/gcm/gcmEncryptExtIV128.rsp")
  (test128-gcm-rsp-decrypt    "rsp/gcm/gcmDecrypt128.rsp"))

(in-package :tls-aes-rsp192-parser)

(defun test-192 ()
  
  (test-ecb192-rsp            "rsp/mmt/ECBMMT192.rsp")
  (test-ecb192-rsp-decrypt    "rsp/mmt/ECBMMT192.rsp")
  (test-cbc192-rsp            "rsp/mmt/CBCMMT192.rsp")
  (test-cbc192-rsp-decrypt    "rsp/mmt/CBCMMT192.rsp")
  (test-ctr192-rsp            "rsp/ctr/CTRMMT192.rsp")
  (test-ctr192-rsp-decrypt    "rsp/ctr/CTRMMT192.rsp")
  (test-ofb192-rsp            "rsp/mmt/OFBMMT192.rsp")
  (test-ofb192-rsp-decrypt    "rsp/mmt/OFBMMT192.rsp")
  (test-cfb192-rsp            "rsp/mmt/CFB128MMT192.rsp")
  (test-cfb192-rsp-decrypt    "rsp/mmt/CFB128MMT192.rsp")
  (test192-cfb8-rsp           "rsp/mmt/CFB8MMT192.rsp")
  (test192-cfb8-rsp-decrypt   "rsp/mmt/CFB8MMT192.rsp")
  (test192-cfb1-rsp           "rsp/mmt/CFB1MMT192.rsp")
  (test192-cfb1-rsp-decrypt   "rsp/mmt/CFB1MMT192.rsp")
  (test192-gcm-rsp            "rsp/gcm/gcmEncryptExtIV192.rsp")
  (test192-gcm-rsp-decrypt    "rsp/gcm/gcmDecrypt192.rsp"))

(in-package :tls-aes-rsp256-parser)

(defun test-256 ()

  (test-ecb256-rsp            "rsp/mmt/ECBMMT256.rsp")
  (test-ecb256-rsp-decrypt    "rsp/mmt/ECBMMT256.rsp")
  (test-cbc256-rsp            "rsp/mmt/CBCMMT256.rsp")
  (test-cbc256-rsp-decrypt    "rsp/mmt/CBCMMT256.rsp")
  (test-ctr256-rsp            "rsp/ctr/CTRMMT256.rsp")
  (test-ctr256-rsp-decrypt    "rsp/ctr/CTRMMT256.rsp")
  (test-ofb256-rsp            "rsp/mmt/OFBMMT256.rsp")
  (test-ofb256-rsp-decrypt    "rsp/mmt/OFBMMT256.rsp")
  (test-cfb256-rsp            "rsp/mmt/CFB128MMT256.rsp")
  (test-cfb256-rsp-decrypt    "rsp/mmt/CFB128MMT256.rsp")
  (test256-cfb8-rsp           "rsp/mmt/CFB8MMT256.rsp")
  (test256-cfb8-rsp-decrypt   "rsp/mmt/CFB8MMT256.rsp")
  (test256-cfb1-rsp           "rsp/mmt/CFB1MMT256.rsp")
  (test256-cfb1-rsp-decrypt   "rsp/mmt/CFB1MMT256.rsp")
  (test256-gcm-rsp            "rsp/gcm/gcmEncryptExtIV256.rsp")
  (test256-gcm-rsp-decrypt    "rsp/gcm/gcmDecrypt256.rsp"))
